{% extends "base.html" %}

{% block title %}
Book Review App
{% endblock %}

{% block content %}
<div class="container">
  <h1 class="text-center">Welcome to Book Review App!</h1>
  {% if current_user.is_authenticated %}
      <p class="text-center">Welcome, {{ current_user.name }}!</p>
      <p class="text-center"><a class="btn btn-secondary" href="{{ url_for('logout') }}">Logout</a></p>
  {% else %}
      <p class="text-center"><a class="btn btn-primary" href="{{ url_for('login') }}">Login</a> or <a class="btn btn-primary" href="{{ url_for('signup') }}">Sign up</a></p>
  {% endif %}
  <hr>
  <h2>Books:</h2>
  {% for book in books %}
    <div class="card mb-3">
      <div class="row g-0">
        <div class="col-md-4">
          <!-- use a placeholder image for now -->
          <img src="https://via.placeholder.com/200" class="img-fluid" alt="...">
        </div>
        <div class="col-md-8">
          <div class="card-body">
            <h5 class="card-title">{{ book.title }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ book.author }}</h6>
            <p class="card-text">{{ book.review }}</p>
            {% if current_user.is_authenticated and (current_user.id == book.user_id or current_user.is_admin) %}
              <form action="{{ url_for('delete_book', book_id=book.id) }}" method="post">
                  <button class="btn btn-danger" type="submit">Delete Book</button>
              </form>
            {% endif %} 
          </div>
        </div>
      </div>
    </div>
    <hr>
  {% endfor %}
  {% if current_user.is_authenticated %}
      <p class="text-center"><a href="{{ url_for('add_book') }}" class="btn btn-success">Add a new book</a></p>
  {% endif %}
</div>
{% endblock %}